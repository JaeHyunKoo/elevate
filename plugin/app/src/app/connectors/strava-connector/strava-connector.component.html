<mat-card>
	<mat-card-title>
		Strava API
	</mat-card-title>
	<mat-card-content>
		<div *ngIf="stravaApiCredentials">
			<div>
				<mat-form-field fxFlex="50">
					<input matInput type="number" min="0" placeholder="Client id"
						   [(ngModel)]="stravaApiCredentials.clientId"
						   (change)="onClientIdChange()">
				</mat-form-field>
			</div>
			<div>
				<mat-form-field fxFlex="50">
					<input matInput [type]="showSecret.checked ? 'text' : 'password'" placeholder="Client secret"
						   [(ngModel)]="stravaApiCredentials.clientSecret" (change)="onClientSecretChange()">
					<button mat-button matSuffix mat-icon-button (click)="showSecret.checked = !showSecret.checked">
						<mat-icon>{{showSecret.checked ? 'visibility_off' : 'visibility'}}</mat-icon>
					</button>
					<mat-checkbox fxHide #showSecret></mat-checkbox>
				</mat-form-field>
			</div>
			<div *ngIf="stravaApiCredentials.accessToken">
				<mat-form-field fxFlex="50">
					<input matInput disabled [type]="showToken.checked ? 'text' : 'password'" placeholder="Access Token"
						   [(ngModel)]="stravaApiCredentials.accessToken">
					<button mat-button matSuffix mat-icon-button (click)="showToken.checked = !showToken.checked">
						<mat-icon>{{showToken.checked ? 'visibility_off' : 'visibility'}}</mat-icon>
					</button>
					<mat-checkbox fxHide #showToken></mat-checkbox>
				</mat-form-field>
			</div>
			<div *ngIf="stravaApiCredentials.refreshToken">
				<mat-form-field fxFlex="50">
					<input matInput disabled [type]="showToken.checked ? 'text' : 'password'"
						   placeholder="Refresh Token"
						   [(ngModel)]="stravaApiCredentials.refreshToken">
					<button mat-button matSuffix mat-icon-button (click)="showToken.checked = !showToken.checked">
						<mat-icon>{{showToken.checked ? 'visibility_off' : 'visibility'}}</mat-icon>
					</button>
					<mat-checkbox fxHide #showToken></mat-checkbox>
				</mat-form-field>
			</div>
			<div *ngIf="stravaApiCredentials.expiresAt > 0">
				<mat-form-field fxFlex="50">
					<input matInput disabled [type]="showToken.checked ? 'text' : 'password'"
						   placeholder="Session valid until" [value]="expiresAt">
					<button mat-button matSuffix mat-icon-button (click)="showToken.checked = !showToken.checked">
						<mat-icon>{{showToken.checked ? 'visibility_off' : 'visibility'}}</mat-icon>
					</button>
					<mat-checkbox fxHide #showToken></mat-checkbox>
				</mat-form-field>
			</div>
			<button mat-stroked-button
					color="primary"
					(click)="stravaAuthentication()"
					[disabled]="(!stravaApiCredentials.clientId || !stravaApiCredentials.clientSecret)">
				<span *ngIf="!stravaApiCredentials.accessToken">Connect to Strava</span>
				<span *ngIf="stravaApiCredentials.accessToken">Reconnect to Strava</span>
			</button>
			<button mat-stroked-button
					color="primary"
					*ngIf="(stravaApiCredentials.clientId > 0 && stravaApiCredentials.clientSecret && stravaApiCredentials.accessToken)"
					(click)="sync()">Sync
			</button>
			<button mat-stroked-button
					color="primary"
					*ngIf="(stravaApiCredentials.clientId > 0 && stravaApiCredentials.clientSecret && stravaApiCredentials.accessToken)"
					(click)="stop()">Stop
			</button>
			<button mat-stroked-button
					color="primary"
					(click)="tmpSetSyncDateTime()">Tmp set last sync date time
			</button>
		</div>
	</mat-card-content>
</mat-card>
